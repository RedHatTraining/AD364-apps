package com.demos.event_planner;

import java.lang.Number;

rule "find-drunks"
	dialect "mvel"
	ruleflow-group "open-bar"
	when
		Guest( $guestName : name)
		Number( $totalAlcohol : intValue() > 200 ) from accumulate ( BarRequest( guestName == $guestName , $ta : totalAlcohol) over window:time (30m),
			sum($ta)) 
	then
		System.out.println($guestName + " has had " + $totalAlcohol + "ml of booze in 30 minutes!")
end
